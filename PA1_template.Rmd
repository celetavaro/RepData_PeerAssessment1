---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
mydata <- read.csv("activity.csv")
mydata$date <- as.Date(mydata$date)
cleanNA <- subset(mydata, !is.na(mydata$steps))
```


## Histogram of the total number of steps each day
```{r sumbyday}
library(ggplot2)
totalEachDay <- tapply(cleanNA$steps, cleanNA$date, sum)
qplot(totalEachDay, ylab = "Frequency", xlab = "Total steps per day", binwidth = 500)
```

## What is mean total number of steps taken per day?

```{r meanacrossdays}
options(scipen = 999) # disables exponential notation 
meanAcrossDays <- mean(totalEachDay)
```
The mean number of steps taken per day: `r meanAcrossDays`


## The median total number of steps taken per day:
```{r medianacrossdays}
medianAcrossDays <- median(totalEachDay)
```
The median number of steps taken per day: `r medianAcrossDays`

## What is the average daily activity pattern?

```{r averages}
avgInterval <-tapply(cleanNA$steps, cleanNA$interval, mean, simplify = TRUE)
df_new <- data.frame(avg = avgInterval, interval = as.integer(names(avgInterval)))
plot(df_new$interval, df_new$avg, type = "l", xlab = "5-minute interval" , ylab = "Average Number Of Steps Across Days")
```


## Imputing missing values

```{r numMissing}
totalNA <- sum(is.na(mydata$steps))
```

The total number of missing values is `r totalNA`

Since we already have the avereages for each interval calculated in the avgIntervals object, we will use those values for the equivalent intervals in the dataset in which we want to impute the values.

```{r}
df_imp <- mydata # copy of original dataframe with missing values
cursor <- is.na(df_imp$steps) # stores indices of missing values
# set missing steps to equivalent interval's average steps
df_imp$steps[cursor] <- avgInterval[as.character(df_imp$interval[cursor])]
df_imp$date <- as.Date(df_imp$date) # convert dates from integers

```
Again, we'll make a histogram and calculate the median and median of steps aross days.

```{r imphist}
totalImp <- with(df_imp, tapply(steps, date, sum))
qplot(totalImp, xlab = "Total Steps per Day", ylab = "Frequency", binwidth = 500)
impMean <- mean(totalImp)
impMed <- median(totalImp)
```

The imputed data mean steps across days calculates to `r impMean`.

The imputed data median steps across days calculates 
to `r impMed`

When we compare this new histogram, mean, and median to the original data, we see that this dataset is not paricularly sensitive to missing values since the numbers look so similar between the two sets.

## Are there differences in activity patterns between weekdays and weekends?

**Important to note:** for this last section of the markdown file, we'll be using the imputed dataset, not the original.

First, we must differentiate between weekdays and weekends:

```{r  warning = FALSE, message=FALSE}
library(lubridate)
    # helper function finds day of week, assigns weekday or weekend
    dow <- function(date){
      
      dayOfWeek <- weekdays(date)
      
      if(dayOfWeek %in% c("Saturday", "Sunday")){
        return("weekend")
      }else{ return ("weekday")} 
      
    }

df_imp$time.of.week <- with(df_imp, sapply(date, FUN = dow))
```

Next, we'll plot the average steps on weekdays and weekends for a comparison of activity levels during these times of the week.

```{r}

wdayAvg <- aggregate(steps ~ time.of.week + interval, data = df_imp, FUN = mean)

g <- ggplot(wdayAvg, aes(interval, steps, colour = time.of.week))
g <- g + geom_line() +
     facet_grid(time.of.week ~ .) +
     xlab("5-minute Interval") +
     ylab("Average Number of Steps")
print(g)
```
