---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
mydata <- read.csv("activity.csv")
mydata$date <- as.Date(mydata$date)
cleanNA <- subset(mydata, !is.na(mydata$steps))
```


## Histogram of the total number of steps each day
```{r sumbyday}
library(ggplot2)
totalEachDay <- tapply(cleanNA$steps, cleanNA$date, sum)
qplot(totalEachDay, ylab = "Frequency", xlab = "Total steps per day", binwidth = 500)
```

## What is mean total number of steps taken per day?

```{r meanacrossdays}
options(scipen = 999) # disables exponential notation 
meanAcrossDays <- mean(totalEachDay)
```
The mean number of steps taken per day: `r meanAcrossDays`


## The median total number of steps taken per day:
```{r medianacrossdays}
medianAcrossDays <- median(totalEachDay)
```
The median number of steps taken per day: `r medianAcrossDays`

## What is the average daily activity pattern?

```{r averages, cache = TRUE}
avgInterval <-tapply(cleanNA$steps, cleanNA$interval, mean, simplify = TRUE)
df_new <- data.frame(avg = avgInterval, interval = as.integer(names(avgInterval)))
plot(df_new$interval, df_new$avg, type = "l", xlab = "5-minute interval" , ylab = "Average Number Of Steps Across Days")
```


## Imputing missing values

```{r numMissing}
totalNA <- sum(is.na(mydata$steps))
```

The total number of missing values is `r totalNA`

Since we already have the avereages for each interval calculated in the avgIntervals object, we will use those values for the equivalent intervals in the dataset in which we want to impute the values.

```{r}
df_imp <- mydata # copy of original dataframe with missing values
cursor <- is.na(df_imp$steps) # stores indices of missing values
df_imp$steps[cursor] <- avgInterval[as.character(df_imp$steps[cursor])] 
# set missing steps to equivalent interval's average steps
```

## Are there differences in activity patterns between weekdays and weekends?
